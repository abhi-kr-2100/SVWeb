{% extends "base.html" %}

{% load static %}

{% block title %}Study Calendar{% endblock %}

{% block content %}
{% if err %}
<div class="alert alert-danger mb-0" role="alert">
    Timezone data for {{ err }} is not yet added. Please let us know that you want it to be added.
</div>
{% endif %}

<div class="dropdown m-3">
    <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton" data-bs-toggle="dropdown" aria-expanded="false">
        Selected timezone: {{ tz }}
    </button>
    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
        {% for t in timezones %}
        <li><a class="dropdown-item" href="{% url 'svhome:calendar-tz' t %}">{{ t }}</a></li>
        {% endfor %}
    </ul>
</div>

<div id="iframe-container" class="d-flex justify-content-center">
</div>

<script>
    (() => {
        const padding = 25;

        let calendarIframe = document.createElement("iframe");
        calendarIframe.setAttribute("src", "https://calendar.google.com/calendar/embed?src=oro5litmqb6972jgi5bgp4dg4k@group.calendar.google.com&ctz={{ tz }}");
        
        calendarIframe.setAttribute("width", String(screen.width - padding));
        if (screen.width < screen.height) { // 4:5 ratio
            calendarIframe.setAttribute("height", String(screen.width * 5.0 / 4.0));
        } else {    // 16:9
            calendarIframe.setAttribute("height", String(screen.width * 9.0 / 16.0));
        }

        let containerDiv = document.getElementById("iframe-container");
        containerDiv.appendChild(calendarIframe);
    })();
</script>
{% endblock %}